
extends layout-default.pug

block head
  script(src="https://kit.fontawesome.com/d5c73f28c4.js", crossorigin="anonymous")
  script(defer src="https://unpkg.com/htmx.org@2.0.4" integrity="sha384-HGfztofotfshcF7+8n44JQL2oJmowVChPTg48S+jvZoztPfvwD79OC/LTtG6dMp+" crossorigin="anonymous")
  link(rel="stylesheet" href="/css/reset.css")
  link(rel="stylesheet" href="/css/tv.css")

block nav
  header#main-top-nav
    nav
      ul#nav-masthead
        li
          h1= appName || 'Node.js Express Mongoose Starter'
      ul#nav-search
        li.search-container.input-group.input-inline
          input.search-input.form-input(
            name='search'
            type='search'
            placeholder='Search media...'
            aria-label='Search'
            hx-get="/library"
            hx-trigger="input delay:1s"
            hx-target="#media-list"
            hx-select="#media-list"
            hx-swap="outerHTML"
          )
      ul#nav-links
        li
          a.btn.btn-link(href="/library/favorites") Favorites
        li
          a.btn.btn-link(href='#documentation') Docs
        li
          a.btn.btn-link(href="/about") About
    #media-control(
      hx-get="/library/status"
      hx-target="#media-control"
      hx-select="#media-control"
      hx-trigger="every 5s"
      hx-swap="outerHTML"
    )
      p Stopped or Disconnected

block main
  main
    section#media-list(
      hx-get="/library"
      hx-trigger="load"
      hx-swap="outerHTML"
      hx-select="#media-list"
      hx-select-oob="#media-control")

    dialog#media-info-dialog
      p This is text
      button Close

    footer

block footScripts
  script.
    // Mobile menu toggle functionality
    const menuToggle = document.getElementById('menuToggle');
    const navMenu = document.getElementById('navMenu');

    menuToggle.addEventListener('click', function() {
      navMenu.classList.toggle('open');
      const isOpen = navMenu.classList.contains('open');
      menuToggle.setAttribute('aria-expanded', isOpen);
      menuToggle.textContent = isOpen ? '✕' : '☰';
    });

    // Close menu when clicking outside
    document.addEventListener('click', function(event) {
      const isClickInsideMenu = navMenu.contains(event.target);
      const isClickOnToggle = menuToggle.contains(event.target);

      if (!isClickInsideMenu && !isClickOnToggle && navMenu.classList.contains('open')) {
        navMenu.classList.remove('open');
        menuToggle.setAttribute('aria-expanded', 'false');
        menuToggle.textContent = '☰';
      }
    });

    // Handle bottom toolbar active state
    const toolbarActions = document.querySelectorAll('.toolbar-action');
    toolbarActions.forEach(action => {
      action.addEventListener('click', function(e) {
        e.preventDefault();
        toolbarActions.forEach(a => a.classList.remove('active'));
        this.classList.add('active');
      });
    });
